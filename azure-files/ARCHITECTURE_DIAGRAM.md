# ğŸ—ï¸ Diagrama de Arquitectura Multicloud AWS + Azure

## Arquitectura Completa

```
                                    INTERNET
                                       |
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    |                                     |
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
              â”‚  Route53  â”‚                         â”‚ Azure DNS â”‚
              â”‚  (AWS)    â”‚                         â”‚           â”‚
              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                    |                                     |
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Application Load     â”‚         â”‚  Application Gateway  â”‚
              â”‚  Balancer (ALB)       â”‚         â”‚  (Azure)              â”‚
              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    |                                     |
                    |                                     |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     AWS VPC (10.0.0.0/16)     â”‚       â”‚ Azure VNet (10.20.0.0/16)  â”‚
    â”‚  Region: us-east-1            â”‚â—„â”€â”€â”€â”€â”€â–ºâ”‚  Region: eastus            â”‚
    â”‚                               â”‚  VPN  â”‚                            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ IPSec â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚  Public Subnets         â”‚ â”‚       â”‚ â”‚  AKS Subnet           â”‚ â”‚
    â”‚  â”‚  - 10.0.0.0/24 (AZ-a)   â”‚ â”‚       â”‚ â”‚  - 10.20.1.0/24       â”‚ â”‚
    â”‚  â”‚  - 10.0.1.0/24 (AZ-b)   â”‚ â”‚       â”‚ â”‚                       â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚                               â”‚       â”‚ â”‚  â”‚ AKS Cluster      â”‚ â”‚ â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”‚  â”‚ - System Pool    â”‚ â”‚ â”‚
    â”‚  â”‚  Private Subnets        â”‚ â”‚       â”‚ â”‚  â”‚ - Microservices  â”‚ â”‚ â”‚
    â”‚  â”‚  - 10.0.10.0/24 (AZ-a)  â”‚ â”‚       â”‚ â”‚  â”‚   Pool           â”‚ â”‚ â”‚
    â”‚  â”‚  - 10.0.11.0/24 (AZ-b)  â”‚ â”‚       â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
    â”‚  â”‚                         â”‚ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚       â”‚                            â”‚
    â”‚  â”‚  â”‚  ECS Cluster        â”‚â”‚ â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚  â”‚  - pdf-generator    â”‚â”‚ â”‚       â”‚ â”‚  Database Subnet       â”‚ â”‚
    â”‚  â”‚  â”‚  - api-gateway      â”‚â”‚ â”‚       â”‚ â”‚  - 10.20.2.0/24       â”‚ â”‚
    â”‚  â”‚  â”‚  - data-processor   â”‚â”‚ â”‚       â”‚ â”‚                       â”‚ â”‚
    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚       â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â”‚  â”‚ CosmosDB         â”‚ â”‚ â”‚
    â”‚                               â”‚       â”‚ â”‚  â”‚ (MongoDB API)    â”‚ â”‚ â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
    â”‚  â”‚  DynamoDB Tables        â”‚ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚  â”‚  - multicloud-dr-data2  â”‚â—„â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”                          â”‚
    â”‚  â”‚  - pdf-metadata         â”‚ â”‚  Sync â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚
    â”‚                               â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”‚  Blob Storage          â”‚
    â”‚  â”‚  S3 Bucket              â”‚ â”‚       â”‚ â”‚  - pdfs container      â”‚
    â”‚  â”‚  - multicloud-pdf-      â”‚â—„â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¤  - s3-replica          â”‚
    â”‚  â”‚    storage-dios-2025    â”‚ â”‚  ADF  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Pipe  â”‚
    â”‚                               â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”‚  Azure Container Reg.  â”‚
    â”‚  â”‚  ECR Repositories       â”‚ â”‚       â”‚ â”‚  (ACR)                 â”‚
    â”‚  â”‚  - pdf-generator        â”‚ â”‚       â”‚ â”‚  - pdf-generator       â”‚
    â”‚  â”‚  - api-gateway          â”‚ â”‚       â”‚ â”‚  - api-gateway         â”‚
    â”‚  â”‚  - data-processor       â”‚ â”‚       â”‚ â”‚  - data-processor      â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                               â”‚       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”‚  CloudWatch             â”‚ â”‚       â”‚ â”‚  Azure Monitor         â”‚
    â”‚  â”‚  - Logs                 â”‚ â”‚       â”‚ â”‚  - Log Analytics       â”‚
    â”‚  â”‚  - Metrics              â”‚ â”‚       â”‚ â”‚  - App Insights        â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de Datos

### 1. Request Flow (Usuario â†’ AplicaciÃ³n)

```
Usuario
  â”‚
  â”œâ”€â–º Route53 (DNS) â”€â”€â–º ALB (AWS) â”€â”€â–º ECS Tasks
  â”‚
  â””â”€â–º Azure DNS â”€â”€â–º Application Gateway â”€â”€â–º AKS Pods
```

### 2. Microservices Communication

```
api-gateway (8080)
  â”‚
  â”œâ”€â–º pdf-generator (8081) â”€â”€â–º S3 / Blob Storage
  â”‚                         â””â”€â–º DynamoDB / CosmosDB
  â”‚
  â””â”€â–º data-processor (8082) â”€â”€â–º DynamoDB / CosmosDB
```

### 3. Data Replication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS S3                                             â”‚
â”‚  multicloud-pdf-storage-dios-2025                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Azure Data Factory
                  â”‚ (Daily Sync @ 2 AM)
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Azure Blob Storage                                 â”‚
â”‚  Container: s3-replica                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS DynamoDB                                       â”‚
â”‚  - multicloud-dr-data2                              â”‚
â”‚  - multicloud-dr-pdf-metadata                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Application-level sync
                  â”‚ or AWS DMS
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Azure CosmosDB (MongoDB API)                       â”‚
â”‚  Database: multicloud-dr-db                         â”‚
â”‚  - main-data collection                             â”‚
â”‚  - pdf-metadata collection                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. VPN Connectivity

```
    AWS VPC                VPN IPSec Tunnel            Azure VNet
  10.0.0.0/16         (Encrypted over Internet)      10.20.0.0/16
      â”‚                                                     â”‚
      â”œâ”€â–º VPN Gateway â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º VPN Gateway â”€â”¤
      â”‚   (AWS CGW)         Shared Key            (Azure)     â”‚
      â”‚                                                        â”‚
      â””â”€â–º Route: 10.20.0.0/16 â†’ VPN      Route: 10.0.0.0/16 â†’ VPN
```

---

## Componentes por Capa

### Capa de PresentaciÃ³n
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS                         Azure                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Application     â”‚        â”‚ Application     â”‚        â”‚
â”‚  â”‚ Load Balancer   â”‚        â”‚ Gateway v2      â”‚        â”‚
â”‚  â”‚ (ALB)           â”‚        â”‚                 â”‚        â”‚
â”‚  â”‚ - Path routing  â”‚        â”‚ - Path routing  â”‚        â”‚
â”‚  â”‚ - Health checks â”‚        â”‚ - Health probes â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Capa de AplicaciÃ³n
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS                         Azure                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ECS Fargate     â”‚        â”‚ AKS (Kubernetes)â”‚        â”‚
â”‚  â”‚                 â”‚        â”‚                 â”‚        â”‚
â”‚  â”‚ â€¢ pdf-gen:8081  â”‚        â”‚ â€¢ pdf-gen:8081  â”‚        â”‚
â”‚  â”‚ â€¢ api-gw:8080   â”‚        â”‚ â€¢ api-gw:8080   â”‚        â”‚
â”‚  â”‚ â€¢ data-proc:8082â”‚        â”‚ â€¢ data-proc:8082â”‚        â”‚
â”‚  â”‚                 â”‚        â”‚                 â”‚        â”‚
â”‚  â”‚ Auto Scaling    â”‚        â”‚ HPA + Node AS   â”‚        â”‚
â”‚  â”‚ 1-4 tasks       â”‚        â”‚ 2-6 pods        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Capa de Datos
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS                         Azure                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ DynamoDB        â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚ CosmosDB        â”‚        â”‚
â”‚  â”‚ (NoSQL)         â”‚  Sync  â”‚ (MongoDB API)   â”‚        â”‚
â”‚  â”‚ â€¢ PAY_PER_REQ   â”‚        â”‚ â€¢ Serverless    â”‚        â”‚
â”‚  â”‚ â€¢ PITR enabled  â”‚        â”‚ â€¢ Multi-region  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ S3              â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚ Blob Storage    â”‚        â”‚
â”‚  â”‚ â€¢ Versioning    â”‚  ADF   â”‚ â€¢ Versioning    â”‚        â”‚
â”‚  â”‚ â€¢ Lifecycle     â”‚        â”‚ â€¢ GRS           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Capa de Monitoreo
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AWS                         Azure                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ CloudWatch      â”‚        â”‚ Azure Monitor   â”‚        â”‚
â”‚  â”‚ â€¢ Logs          â”‚        â”‚ â€¢ Log Analytics â”‚        â”‚
â”‚  â”‚ â€¢ Metrics       â”‚        â”‚ â€¢ App Insights  â”‚        â”‚
â”‚  â”‚ â€¢ Alarms        â”‚        â”‚ â€¢ Alerts        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## TopologÃ­a de Red Detallada

```
AWS VPC: 10.0.0.0/16                    Azure VNet: 10.20.0.0/16
â”œâ”€ Public Subnet A: 10.0.0.0/24         â”œâ”€ AKS Subnet: 10.20.1.0/24
â”‚  â””â”€ ALB                               â”‚  â””â”€ AKS Nodes (2-6)
â”œâ”€ Public Subnet B: 10.0.1.0/24         â”‚
â”‚  â””â”€ NAT Gateway                       â”œâ”€ Database Subnet: 10.20.2.0/24
â”œâ”€ Private Subnet A: 10.0.10.0/24       â”‚  â”œâ”€ CosmosDB Private Endpoint
â”‚  â””â”€ ECS Tasks                         â”‚  â””â”€ Storage Private Endpoint
â”œâ”€ Private Subnet B: 10.0.11.0/24       â”‚
â”‚  â””â”€ ECS Tasks                         â”œâ”€ AppGW Subnet: 10.20.3.0/24
â”‚                                       â”‚  â””â”€ Application Gateway
â””â”€ VPN Gateway                          â”‚
   â””â”€ Public IP: X.X.X.X                â””â”€ Gateway Subnet: 10.20.255.0/27
                                           â””â”€ VPN Gateway
                                              â””â”€ Public IP: Y.Y.Y.Y
```

---

## Failover Scenarios

### Scenario 1: AWS Region Down
```
User Request
    â”‚
    â”œâ”€ Route53 (Health Check Fails)
    â”‚
    â””â”€â–º FAILOVER to Azure DNS
         â”‚
         â””â”€â–º Application Gateway (Azure)
              â”‚
              â””â”€â–º AKS Pods
                   â”‚
                   â””â”€â–º CosmosDB (Azure)
                        â””â”€â–º Blob Storage (Azure)
```

### Scenario 2: Azure Region Down
```
User Request
    â”‚
    â”œâ”€ Azure DNS (Unavailable)
    â”‚
    â””â”€â–º FAILBACK to Route53
         â”‚
         â””â”€â–º ALB (AWS)
              â”‚
              â””â”€â–º ECS Tasks
                   â”‚
                   â””â”€â–º DynamoDB (AWS)
                        â””â”€â–º S3 (AWS)
```

### Scenario 3: Database Sync Failure
```
AWS DynamoDB (Primary)
    â”‚
    â”œâ”€ Write Operation Success
    â”‚
    â””â”€ Sync to CosmosDB Failed
         â”‚
         â””â”€â–º Retry Mechanism (Lambda/Function)
         â”‚
         â””â”€â–º Manual Reconciliation via Data Factory
```

---

## Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 7 - Application                                  â”‚
â”‚  â€¢ Application Gateway WAF (Azure)                      â”‚
â”‚  â€¢ ALB with SSL/TLS (AWS)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 4 - Transport                                    â”‚
â”‚  â€¢ NSGs (Azure) / Security Groups (AWS)                â”‚
â”‚  â€¢ Network Policies (Kubernetes)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3 - Network                                      â”‚
â”‚  â€¢ VPN IPSec Encryption                                â”‚
â”‚  â€¢ Private Endpoints (Azure)                            â”‚
â”‚  â€¢ VPC Endpoints (AWS)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2 - Data                                         â”‚
â”‚  â€¢ Storage Encryption at Rest (AES-256)                â”‚
â”‚  â€¢ Database Encryption                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 1 - Identity                                     â”‚
â”‚  â€¢ Azure AD RBAC                                        â”‚
â”‚  â€¢ AWS IAM Roles                                        â”‚
â”‚  â€¢ Kubernetes RBAC                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Order

```
1. Terraform AWS Infrastructure
   â””â”€â–º VPC, ECS, DynamoDB, S3, ALB
        â”‚
        â””â”€â–º Get VPN Gateway IP
             â”‚
2. Terraform Azure Infrastructure â—„â”€â”€â”€â”˜
   â””â”€â–º VNet, AKS, CosmosDB, Blob, AppGW, VPN
        â”‚
        â””â”€â–º Get VPN Gateway IP
             â”‚
3. Configure AWS VPN â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â””â”€â–º Customer Gateway, VPN Connection
        â”‚
4. Update Azure VPN Configuration
   â””â”€â–º Local Network Gateway, VPN Connection
        â”‚
5. Deploy Microservices
   â””â”€â–º Build Images â†’ Push to ACR â†’ Deploy to AKS
        â”‚
6. Configure Data Replication
   â””â”€â–º Data Factory Pipeline, DMS Setup
        â”‚
7. Testing & Validation
   â””â”€â–º Connectivity, Failover, Performance
```

---

**Este diagrama representa la arquitectura completa multicloud AWS + Azure implementada.**
